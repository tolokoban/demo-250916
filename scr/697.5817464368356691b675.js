"use strict";(self.webpackChunk_My_Game_=self.webpackChunk_My_Game_||[]).push([[697],{697:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var n=r(848),o=r(498);function a(e,t){const r=20*Math.sin(t),n=20*Math.sin(.715*t);e.setEulerRotation(r,n,0)}class s extends o.tbm{constructor(e,{asset:t}){super();const r=new o.dRj(e,{asset:t,material:new o.MZk});this.transfo=r.transfo;const n=new o.Ipk(e,{depth:o.Eg5.lessOrEqual,children:[r]}),a=new o.EWU([new o.o57(e,{color:[.5,.5,1,1],depth:1}),n]),s=new o.K7(e,{viewportMatchingScale:.25,depthBuffer:!0,textureColor0:new o.HTX(e),children:[a]});if(!s.textureColor0)throw new Error("No textureColor0 found in TgdPainterFramebuffer!");const i=new o.D$w(e,{texture:s.textureColor0,filters:[new o.vAg({size:2,direction:0}),new o.vAg({size:2,direction:90})],flipY:!0}),l=new o.K7(e,{viewportMatchingScale:.25,depthBuffer:!1,textureColor0:new o.HTX(e),children:[i]});if(!l.textureColor0)throw new Error("No textureColor0 found in TgdPainterFramebuffer!");this.texture=l.textureColor0,this.painter=new o.EWU([s,l])}delete(){this.painter.delete()}paint(e,t){a(this.transfo,e),this.painter.paint(e,t)}}class i extends o.tbm{constructor(e,{background:t,normalMap:r,depth:n}){super(),this.context=e,this.clear=new o.o57(e,{depth:1}),this.textureNormalMap=r,this.textureDepth=n;const a=new o.HTX(e).loadBitmap(t);this.textureBackground=a;const s=new o.a6X(e.gl,{vert:new o.dLJ({attributes:{attPos:"vec2",attUV1:"vec2"},varying:{varPos:"vec2",varUV1:"vec2"},mainCode:["varPos = attPos;","varUV1 = attUV1;","gl_Position = vec4(attPos, 1.0, 1.0);"]}).code,frag:new o.NI6({uniforms:{uniTime:"float",uniAspect:"vec2",texDepth:"sampler2D",texBackground:"sampler2D",texNormals:"sampler2D"},varying:{varPos:"vec2",varUV1:"vec2"},outputs:{FragColor:"vec4"},functions:{...(0,o.BWl)(),...(0,o.N0o)()},mainCode:["float MIN = 0.7;","float MAX = 0.9;","float offset = 1.0 - abs(sin(uniTime * 5.0));","float depth = vec3ToFloat01(",["texture(texDepth, varUV1).rgb"],");","float height = max(0.0, mapRange(depth, MIN, MAX, 1.0, 0.0) - offset);","vec3 normal = texture(texNormals, varUV1).rgb;","normal += vec3(-.5, -.5, 0);","normal *= vec3(2, 2, 1);","normal = normalize(normal);","vec2 pos = varPos;","pos += height * normal.xy;","vec2 uv = pos * uniAspect + vec2(0, .2 * uniTime);","uv.y += pos.x > 0.0 ? .7 : 0.0;","vec4 color = texture(texBackground, uv);","FragColor = vec4(color.rgb, 1);","if (height > 0.0) {",["float light = 1.0 - pow(1.0 - normal.z, 2.0);","light = .25 + .75 * light;","FragColor.rgb *= light;"],"}"]}).code});this.program=s;const i=new o.I9j({attPos:"vec2",attUV1:"vec2",attUV2:"vec2"}),l=1e-9;i.set("attPos",new Float32Array([-1,-1,-1,1,-l,-1,-l,1,+l,-1,+l,1,1,-1,1,1])),i.set("attUV1",new Float32Array([0,0,0,1,.5,0,.5,1,.5,0,.5,1,1,0,1,1])),this.drawingMode=WebGL2RenderingContext.TRIANGLE_STRIP,this.count=8;const c=new o.ZV_(e.gl,s,[i]);this.vao=c}delete(){this.textureBackground.delete(),this.vao.delete(),this.program.delete()}paint(e,t){const{context:r,clear:n,program:a,vao:s,textureBackground:i,textureNormalMap:l,textureDepth:c,drawingMode:u,count:h}=this,{gl:d,width:p,height:f}=r;n.paint(),a.use(),a.uniform1f("uniTime",.05*e);const g=i.width/i.height;p<f?a.uniform2f("uniAspect",p/f,-g):a.uniform2f("uniAspect",1,-g*f/p),i.activate(0,a,"texBackground"),l.activate(1,a,"texNormals"),c.activate(2,a,"texDepth"),s.bind(),o.Ipk.do({gl:d,depth:o.Eg5.lessOrEqual},()=>{d.drawArrays(u,0,h)}),s.unbind()}}var l=r(883);class c extends o.tbm{constructor(e,{asset:t}){super();const r=new o.dRj(e,{asset:t,material:new o._Lj});this.transfo=r.transfo;const n=new o.Ipk(e,{depth:o.Eg5.lessOrEqual,children:[r]}),a=new o.EWU([new o.o57(e,{color:[1,1,1,1],depth:1}),n]),s=new o.K7(e,{viewportMatchingScale:1,depthBuffer:!0,textureColor0:new o.HTX(e),children:[a]});if(!s.textureColor0)throw new Error("No textureColor0 found in TgdPainterFramebuffer!");this.texture=s.textureColor0,this.painter=s}delete(){this.painter.delete()}paint(e,t){a(this.transfo,e),this.painter.paint(e,t)}}const u={main:"yWd8oPugx5O0Dhk7Mwjj"};function h(){const e=function(){const e=(0,l.dU)();return t=>{if(!t)return;const r=new o.xNY({transfo:{distance:3,position:[0,0,0]},far:5,near:1,fovy:Math.PI/4}),n=new o.tfp(t,{camera:r}),a=new s(n,{asset:e.glb.skull}),l=new c(n,{asset:e.glb.skull}),u=new i(n,{background:e.img.background,normalMap:a.texture,depth:l.texture});n.add(a,l,u),n.play(),new o.pwt(n,{geo:{minLat:(0,o.HPH)(-20),maxLat:(0,o.HPH)(20),minLng:(0,o.HPH)(-60),maxLng:(0,o.HPH)(60)},inertiaOrbit:3e3})}}();return(0,n.jsx)("div",{className:u.main,children:(0,n.jsx)("canvas",{ref:e})})}}}]);